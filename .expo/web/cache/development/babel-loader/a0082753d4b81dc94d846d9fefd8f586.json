{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/steven/Desktop/CupOJavaScript/components/BarcodeScanner.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { BarCodeScanner } from \"expo-barcode-scanner\";\nimport { sendApiRequest } from \"../screens/old/Edamam\";\nimport styles from \"../screens/old/globalstyles.js\";\nimport fire from \"./fire\";\nexport var BarcodeScanner = function BarcodeScanner() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasPermission = _useState2[0],\n      setHasPermission = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      scanned = _useState4[0],\n      setScanned = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      pageSwitch = _useState6[0],\n      setPageSwitch = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      calories = _useState8[0],\n      setCalories = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      foodName = _useState10[0],\n      setFoodName = _useState10[1];\n\n  var usersDB = fire.firestore().collection('users');\n  var userID = fire.auth().currentUser.uid;\n  useEffect(function () {\n    (function _callee() {\n      var _await$BarCodeScanner, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(BarCodeScanner.requestPermissionsAsync());\n\n            case 2:\n              _await$BarCodeScanner = _context.sent;\n              status = _await$BarCodeScanner.status;\n              setHasPermission(status === 'granted');\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  function pageSwitchHandler() {\n    setPageSwitch(!pageSwitch);\n  }\n\n  function CalorieCount() {\n    fire.database().ref('users/' + fire.auth().currentUser.email.replace('.', ',') + \"/caloriesConsumed\").on('value', function (snapshot) {\n      var data = snapshot.val();\n      setCalories(data);\n    });\n  }\n\n  function handleSaveFood(name) {\n    (function (name) {\n      return console.log(\"OK Pressed, Food Name: \" + name);\n    });\n\n    setFoodName(name);\n    var newDailyFood = {\n      name: name,\n      calories: calories\n    };\n    usersDB.doc(userID).collection(\"DailyFood\").add(newDailyFood).then(function (result) {\n      console.log(result);\n    }).catch(function (error) {\n      console.log(error);\n      Alert.alert('Error', error.message, [{\n        text: 'OK'\n      }], {\n        cancelable: true\n      });\n    });\n  }\n\n  var handleBarCodeScanned = function handleBarCodeScanned(_ref) {\n    var data = _ref.data;\n    setScanned(true);\n    sendApiRequest(data);\n    setPageSwitch(true);\n    CalorieCount();\n    setScanned(false);\n  };\n\n  if (hasPermission === null) {\n    return React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 16\n      }\n    }, \"Requesting for camera permission\");\n  }\n\n  if (hasPermission === false) {\n    return React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 16\n      }\n    }, \"No access to camera\");\n  }\n\n  function addToFood() {\n    Alert.prompt(\"Enter Food Name\", \"\", [{\n      text: \"Cancel\",\n      onPress: function onPress() {\n        return console.log(\"Cancel Pressed\");\n      },\n      style: \"cancel\"\n    }, {\n      text: \"OK\",\n      onPress: function onPress(name) {\n        return handleSaveFood(name);\n      }\n    }]);\n  }\n\n  return React.createElement(React.Fragment, null, pageSwitch ? React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }, \"Calories: \", calories), React.createElement(TouchableOpacity, {\n    style: styles.loginBtn,\n    onPress: pageSwitchHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }, \"Scan Again\")), React.createElement(TouchableOpacity, {\n    style: styles.loginBtn,\n    onPress: addToFood,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  }, \"Add To Food\"))) : React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, React.createElement(BarCodeScanner, {\n    onBarCodeScanned: scanned ? undefined : handleBarCodeScanned,\n    style: StyleSheet.absoluteFill,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }), React.createElement(View, {\n    style: styles.scannerMask,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  })));\n};","map":{"version":3,"sources":["/Users/steven/Desktop/CupOJavaScript/components/BarcodeScanner.js"],"names":["React","useState","useEffect","BarCodeScanner","sendApiRequest","styles","fire","BarcodeScanner","hasPermission","setHasPermission","scanned","setScanned","pageSwitch","setPageSwitch","calories","setCalories","foodName","setFoodName","usersDB","firestore","collection","userID","auth","currentUser","uid","requestPermissionsAsync","status","pageSwitchHandler","CalorieCount","database","ref","email","replace","on","snapshot","data","val","handleSaveFood","name","console","log","newDailyFood","doc","add","then","result","catch","error","Alert","alert","message","text","cancelable","handleBarCodeScanned","addToFood","prompt","onPress","style","container","loginBtn","undefined","StyleSheet","absoluteFill","scannerMask"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA4C,OAA5C;;;;;;;;AAEA,SAAQC,cAAR,QAA6B,sBAA7B;AACA,SAAQC,cAAR;AACA,OAAOC,MAAP;AACA,OAAOC,IAAP;AAIA,OAAO,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAAA,kBACUN,QAAQ,CAAC,IAAD,CADlB;AAAA;AAAA,MACzBO,aADyB;AAAA,MACVC,gBADU;;AAAA,mBAEFR,QAAQ,CAAC,KAAD,CAFN;AAAA;AAAA,MAEzBS,OAFyB;AAAA,MAEhBC,UAFgB;;AAAA,mBAGIV,QAAQ,CAAC,KAAD,CAHZ;AAAA;AAAA,MAGzBW,UAHyB;AAAA,MAGbC,aAHa;;AAAA,mBAIAZ,QAAQ,CAAC,CAAD,CAJR;AAAA;AAAA,MAIzBa,QAJyB;AAAA,MAIfC,WAJe;;AAAA,mBAKAd,QAAQ,CAAC,EAAD,CALR;AAAA;AAAA,MAKzBe,QALyB;AAAA,MAKfC,WALe;;AAOhC,MAAMC,OAAO,GAAGZ,IAAI,CAACa,SAAL,GAAiBC,UAAjB,CAA4B,OAA5B,CAAhB;AACA,MAAMC,MAAM,GAAGf,IAAI,CAACgB,IAAL,GAAYC,WAAZ,CAAwBC,GAAvC;AAEAtB,EAAAA,SAAS,CAAC,YAAM;AACZ,KAAC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAC0BC,cAAc,CAACsB,uBAAf,EAD1B;;AAAA;AAAA;AACUC,cAAAA,MADV,yBACUA,MADV;AAEGjB,cAAAA,gBAAgB,CAACiB,MAAM,KAAK,SAAZ,CAAhB;;AAFH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;AAIH,GALQ,EAKN,EALM,CAAT;;AASA,WAASC,iBAAT,GAA6B;AACzBd,IAAAA,aAAa,CAAC,CAACD,UAAF,CAAb;AACH;;AACD,WAASgB,YAAT,GAAwB;AACpBtB,IAAAA,IAAI,CAACuB,QAAL,GAAgBC,GAAhB,CAAoB,WAAWxB,IAAI,CAACgB,IAAL,GAAYC,WAAZ,CAAwBQ,KAAxB,CAA8BC,OAA9B,CAAsC,GAAtC,EAA0C,GAA1C,CAAX,GAA4D,mBAAhF,EAAqGC,EAArG,CAAwG,OAAxG,EAAiH,UAAAC,QAAQ,EAAI;AACzH,UAAMC,IAAI,GAAGD,QAAQ,CAACE,GAAT,EAAb;AACArB,MAAAA,WAAW,CAACoB,IAAD,CAAX;AACH,KAHD;AAIH;;AAED,WAASE,cAAT,CAAwBC,IAAxB,EAA8B;AAC1B,eAAAA,IAAI;AAAA,aAAIC,OAAO,CAACC,GAAR,CAAY,4BAA4BF,IAAxC,CAAJ;AAAA,KAAJ;;AACArB,IAAAA,WAAW,CAACqB,IAAD,CAAX;AACA,QAAIG,YAAY,GAAG;AAAEH,MAAAA,IAAI,EAAEA,IAAR;AAAcxB,MAAAA,QAAQ,EAAEA;AAAxB,KAAnB;AAEAI,IAAAA,OAAO,CAACwB,GAAR,CAAYrB,MAAZ,EAAoBD,UAApB,CAA+B,WAA/B,EAA4CuB,GAA5C,CAAgDF,YAAhD,EACCG,IADD,CACM,UAACC,MAAD,EAAY;AACdN,MAAAA,OAAO,CAACC,GAAR,CAAYK,MAAZ;AACH,KAHD,EAICC,KAJD,CAIO,UAACC,KAAD,EAAW;AACdR,MAAAA,OAAO,CAACC,GAAR,CAAYO,KAAZ;AACAC,MAAAA,KAAK,CAACC,KAAN,CAAY,OAAZ,EAAqBF,KAAK,CAACG,OAA3B,EAAoC,CAAC;AAACC,QAAAA,IAAI,EAAE;AAAP,OAAD,CAApC,EAAqD;AAACC,QAAAA,UAAU,EAAE;AAAb,OAArD;AACH,KAPD;AAQH;;AAED,MAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,OAAY;AAAA,QAAVlB,IAAU,QAAVA,IAAU;AACrCxB,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAP,IAAAA,cAAc,CAAC+B,IAAD,CAAd;AACAtB,IAAAA,aAAa,CAAC,IAAD,CAAb;AACAe,IAAAA,YAAY;AACZjB,IAAAA,UAAU,CAAC,KAAD,CAAV;AACH,GAND;;AAQA,MAAIH,aAAa,KAAK,IAAtB,EAA4B;AACxB,WAAO,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAAP;AACH;;AACD,MAAIA,aAAa,KAAK,KAAtB,EAA6B;AACzB,WAAO,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAP;AACH;;AAED,WAAS8C,SAAT,GAAqB;AACjBN,IAAAA,KAAK,CAACO,MAAN,CACI,iBADJ,EAEI,EAFJ,EAGI,CACI;AACEJ,MAAAA,IAAI,EAAE,QADR;AAEEK,MAAAA,OAAO,EAAE;AAAA,eAAMjB,OAAO,CAACC,GAAR,CAAY,gBAAZ,CAAN;AAAA,OAFX;AAGEiB,MAAAA,KAAK,EAAE;AAHT,KADJ,EAMI;AACEN,MAAAA,IAAI,EAAE,IADR;AAEEK,MAAAA,OAAO,EAAE,iBAAClB,IAAD;AAAA,eAAUD,cAAc,CAACC,IAAD,CAAxB;AAAA;AAFX,KANJ,CAHJ;AAeH;;AAED,SACI,0CAEC1B,UAAU,GACX,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEP,MAAM,CAACqD,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAiB5C,QAAjB,CADJ,EAEI,oBAAC,gBAAD;AAAkB,IAAA,KAAK,EAAET,MAAM,CAACsD,QAAhC;AAA0C,IAAA,OAAO,EAAEhC,iBAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,CAFJ,EAKI,oBAAC,gBAAD;AAAkB,IAAA,KAAK,EAAEtB,MAAM,CAACsD,QAAhC;AAA0C,IAAA,OAAO,EAAEL,SAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADJ,CALJ,CADW,GAaX,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEjD,MAAM,CAACqD,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,cAAD;AACI,IAAA,gBAAgB,EAAEhD,OAAO,GAAGkD,SAAH,GAAeP,oBAD5C;AAEI,IAAA,KAAK,EAAEQ,UAAU,CAACC,YAFtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAKI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAIzD,MAAM,CAAC0D,WAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALJ,CAfA,CADJ;AA0BH,CAvGM","sourcesContent":["import React, { useState, useEffect }  from \"react\";\nimport {Text, View, StyleSheet, TouchableOpacity, Dimensions, Button, Alert} from \"react-native\";\nimport {BarCodeScanner} from \"expo-barcode-scanner\";\nimport {sendApiRequest} from \"../screens/old/Edamam\";\nimport styles from '../screens/old/globalstyles.js';\nimport fire from './fire';\n\n\n\nexport const BarcodeScanner = () => {\n    const [hasPermission, setHasPermission] = useState(null);\n    const [scanned, setScanned] = useState(false);\n    const [pageSwitch, setPageSwitch] = useState(false);\n    const [calories, setCalories] = useState(0);\n    const [foodName, setFoodName] = useState(\"\");\n\n    const usersDB = fire.firestore().collection('users')\n    const userID = fire.auth().currentUser.uid\n\n    useEffect(() => {\n        (async () => {\n            const {status} = await BarCodeScanner.requestPermissionsAsync();\n            setHasPermission(status === 'granted');\n        })();\n    }, []);\n\n\n    //flip switch to transition back to barcode scanner\n    function pageSwitchHandler() {\n        setPageSwitch(!pageSwitch);\n    }\n    function CalorieCount() {\n        fire.database().ref('users/' + fire.auth().currentUser.email.replace('.',',') + \"/caloriesConsumed\").on('value',(snapshot => {\n            const data = snapshot.val();\n            setCalories(data);\n        }))\n    }\n\n    function handleSaveFood(name) {\n        name => console.log(\"OK Pressed, Food Name: \" + name)\n        setFoodName(name)\n        let newDailyFood = { name: name, calories: calories}\n\n        usersDB.doc(userID).collection(\"DailyFood\").add(newDailyFood)\n        .then((result) => {\n            console.log(result)\n        })\n        .catch((error) => {\n            console.log(error)\n            Alert.alert('Error', error.message, [{text: 'OK'},], {cancelable: true});\n        });\n    }\n//triggered after scanning barcode, flips switches and transitions to calorie view\n    const handleBarCodeScanned = ({data}) => {\n        setScanned(true);\n        sendApiRequest(data);\n        setPageSwitch(true);\n        CalorieCount();\n        setScanned(false);\n    };\n// prompt for permissions access from the user device\n    if (hasPermission === null) {\n        return <Text>Requesting for camera permission</Text>;\n    }\n    if (hasPermission === false) {\n        return <Text>No access to camera</Text>;\n    }\n\n    function addToFood() {\n        Alert.prompt(\n            \"Enter Food Name\",\n            \"\",\n            [\n                {\n                  text: \"Cancel\",\n                  onPress: () => console.log(\"Cancel Pressed\"),\n                  style: \"cancel\"\n                },\n                {\n                  text: \"OK\",\n                  onPress: (name) => handleSaveFood(name)\n                }\n              ],\n        )\n    }\n// returns the page view for the barcode scanner\n    return (\n        <>\n\n        {pageSwitch ? (\n        <View style={styles.container}>\n            <Text>Calories: {calories}</Text>\n            <TouchableOpacity style={styles.loginBtn} onPress={pageSwitchHandler}>\n                <Text>Scan Again</Text>\n            </TouchableOpacity>\n            <TouchableOpacity style={styles.loginBtn} onPress={addToFood}>\n                <Text>Add To Food</Text>\n            </TouchableOpacity>\n\n        </View>\n\n        ):(\n        <View style={styles.container}>\n            <BarCodeScanner\n                onBarCodeScanned={scanned ? undefined : handleBarCodeScanned}\n                style={StyleSheet.absoluteFill}\n            />\n            <View style = {styles.scannerMask}/>\n        </View>\n        )}\n        </>\n    );\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}